const inquirer = require('inquirer')

module.exports = (program) => {
    program
        .version('0.0.1')
        .command('task')
        .action(async cmd => {
            if (!cmd.dir) {
                console.log("Add a directory using --dir. Path must be absolute");
            }
            else {
                try {
                    let child = spawn('node', ['./server-process', cmd.port], {
                        detached: true
                    });

                    child.stderr.on('data', (data) => {
                        console.log('Error while listening to port', cmd.port);
                    });
                    addAgent(cmd.port, false, true, cmd.dir);
                }
                catch (err) {
                    console.log(err);
                }

            }

        });
}